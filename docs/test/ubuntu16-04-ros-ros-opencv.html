<html class="notion-html" lang="en"><head><meta charset="utf-8"/><meta content="width=device-width,height=device-height,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover" name="viewport"/><title>ubuntu16.04下ROS操作系统学习笔记（六 ）机器视觉-摄像头标定-ROS+OpenCv-人脸识别-物体跟踪-二维码识别 - 古月居</title><meta content="en_US" property="og:locale"/><link href="/images/favicon.ico" rel="shortcut icon" type="image/x-icon"/><link href="/images/logo-ios.png" rel="apple-touch-icon"/><meta content="yes" name="apple-mobile-web-app-capable"/><meta content="telephone=no" name="format-detection"/><meta content="no" name="msapplication-tap-highlight"/><link href="4c758603f1604611142662f0ddecadcb583394b5.css" media="print" rel="stylesheet"/><link href="5bac511d4358fedf8fc577a9af95b2d91a429351.css" rel="stylesheet"/><link href="6cb5ab61248391df951f5ce1297730fc4d573f46.css" rel="stylesheet"/></head><body class="notion-body"><style>body{background:#fff}body.dark{background:#2f3437}.initial-loading-spinner{-webkit-animation:rotate 1s linear infinite;animation:rotate 1s linear infinite;-webkit-transform-origin:center center;transform-origin:center center;width:1em;height:1em;opacity:.5;display:block;pointer-events:none}@-webkit-keyframes rotate{0%{-webkit-transform:rotate(0) translateZ(0);transform:rotate(0) translateZ(0)}100%{-webkit-transform:rotate(360deg) translateZ(0);transform:rotate(360deg) translateZ(0)}}@keyframes rotate{0%{-webkit-transform:rotate(0) translateZ(0);transform:rotate(0) translateZ(0)}100%{-webkit-transform:rotate(360deg) translateZ(0);transform:rotate(360deg) translateZ(0)}}</style><style id="scroll-properties">
			::-webkit-scrollbar {
				width: 10px;
				height: 10px;
			}
			::-webkit-scrollbar {
				background: transparent;
			}
			::-webkit-scrollbar-track {
				background: #EDECE9;
			}
			::-webkit-scrollbar-thumb {
				background:#D3D1CB;
			}
			::-webkit-scrollbar-thumb:hover {
				background:#AEACA6;
			}
		</style><div id="notion-app"><div class="notion-app-inner notion-light-theme" style='color: rgb(55, 53, 47); fill: currentcolor; line-height: 1.5; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; -webkit-font-smoothing: auto;'><div class="notion-cursor-listener" style="width: 100vw; height: 100%; position: relative; display: flex; flex: 1 1 0%; background: white; cursor: text;"><div class="notion-frame" style="flex-grow: 1; flex-shrink: 1; display: flex; flex-direction: column; background: white; z-index: 1; height: 100vh; max-height: 100%; width: 1920px;"><div style="width: 100%; max-width: 100vw; z-index: 9;"><div class="notion-topbar" style="width: 100%; max-width: 100vw; height: 45px; opacity: 1; transition: opacity 700ms ease 0s, color 700ms ease 0s; position: relative;"><div style="display: flex; justify-content: space-between; align-items: center; position: absolute; overflow: hidden; height: 45px; left: 0px; right: 0px; bottom: 0px; padding-left: 12px; padding-right: 10px;"><div class="notranslate" style="display: flex; align-items: center; line-height: 1.2; font-size: 14px; height: 100%; flex-grow: 0; margin-right: 8px; min-width: 0px;"><div class="notion-selectable notion-page-block" data-block-id="a0929b1c-3a5e-4e87-96cf-50cf06eb4f1d" style="display: flex; align-items: center; min-width: 0px;"><a href="index.html" rel="noopener noreferrer" style="display: flex; text-decoration: none; user-select: none; cursor: pointer; color: inherit; min-width: 0px;"><div class="notion-focusable" role="button" style="user-select: none; transition: background 20ms ease-in 0s; cursor: pointer; display: inline-flex; align-items: center; flex-shrink: 1; white-space: nowrap; height: 24px; border-radius: 3px; font-size: inherit; line-height: 1.2; min-width: 0px; padding-left: 6px; padding-right: 6px; color: rgb(55, 53, 47);" tabindex="-1"><div style="display: flex; align-items: center; min-width: 0px;"><div aria-disabled="true" class="notion-record-icon notranslate notion-focusable" role="button" style="user-select: none; transition: background 20ms ease-in 0s; display: flex; align-items: center; justify-content: center; height: 20px; width: 20px; border-radius: 3px; flex-shrink: 0; margin-right: 6px;" tabindex="-1"><div style="display: flex; align-items: center; justify-content: center; height: 20px; width: 20px;"><div style="height: 14px; width: 14px; font-size: 14px; line-height: 1.1; margin-left: 0px; color: black;"><img alt="🤖" aria-label="🤖" class="notion-emoji" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" style="width: 100%;
height: 100%;
background: url(9a8c947f139c3e6c1d3d11e3f0ecbc261719de6f.png) 66.0714% 51.7857%/5700% 5700%"/></div></div></div><div class="notranslate" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 160px;"><span>[Shared] EE346 Lab1-7</span></div></div></div></a></div><span style="margin-left: 2px; margin-right: 2px; color: rgba(55, 53, 47, 0.4);">/</span><div class="notion-selectable notion-page-block" data-block-id="0d91c00e-b304-49bc-8d8c-baa7c2184cf8" style="display: flex; align-items: center; min-width: 0px;"><a href="lab3-racing-and-ar-tag-recognition.html" rel="noopener noreferrer" style="display: flex; text-decoration: none; user-select: none; cursor: pointer; color: inherit; min-width: 0px;"><div class="notion-focusable" role="button" style="user-select: none; transition: background 20ms ease-in 0s; cursor: pointer; display: inline-flex; align-items: center; flex-shrink: 1; white-space: nowrap; height: 24px; border-radius: 3px; font-size: inherit; line-height: 1.2; min-width: 0px; padding-left: 6px; padding-right: 6px; color: rgb(55, 53, 47);" tabindex="-1"><div style="display: flex; align-items: center; min-width: 0px;"><div aria-disabled="true" class="notion-record-icon notranslate notion-focusable" role="button" style="user-select: none; transition: background 20ms ease-in 0s; display: flex; align-items: center; justify-content: center; height: 20px; width: 20px; border-radius: 3px; flex-shrink: 0; margin-right: 6px;" tabindex="-1"><div style="display: flex; align-items: center; justify-content: center; height: 20px; width: 20px;"><div style="height: 14px; width: 14px; font-size: 14px; line-height: 1.1; margin-left: 0px; color: black;"><img alt="📜" aria-label="📜" class="notion-emoji" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" style="width: 100%;
height: 100%;
background: url(9a8c947f139c3e6c1d3d11e3f0ecbc261719de6f.png) 46.4286% 89.2857%/5700% 5700%"/></div></div></div><div class="notranslate" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 160px;"><span>Lab3 Racing and AR Tag Recognition</span></div></div></div></a></div><span style="margin-left: 2px; margin-right: 2px; color: rgba(55, 53, 47, 0.4);">/</span><div aria-disabled="true" class="notion-focusable" role="button" style="user-select: none; transition: background 20ms ease-in 0s; display: inline-flex; align-items: center; flex-shrink: 1; white-space: nowrap; height: 24px; border-radius: 3px; font-size: 14px; line-height: 1.2; min-width: 0px; padding-left: 6px; padding-right: 6px; color: rgb(55, 53, 47);" tabindex="-1"><div class="notranslate" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 240px;"><span>ubuntu16.04下ROS操作系统学习笔记（六 ）机器视觉-摄像头标定-ROS+OpenCv-人脸识别-物体跟踪-二维码识别 - 古月居</span></div></div></div><div style="flex-grow: 1; flex-shrink: 1;"></div><div class="notion-focusable" role="button" style="user-select: none; transition: background 20ms ease-in 0s; cursor: pointer; display: inline-flex; align-items: center; flex-shrink: 0; white-space: nowrap; height: 28px; border-radius: 3px; font-size: 14px; line-height: 1.2; min-width: 0px; padding-left: 8px; padding-right: 8px; color: rgb(55, 53, 47);" tabindex="-1"><svg class="searchNew" style="width: 14px; height: 14px; display: block; fill: inherit; flex-shrink: 0; backface-visibility: hidden; margin-right: 6px;" viewbox="0 0 17 17"><path d="M6.78027 13.6729C8.24805 13.6729 9.60156 13.1982 10.709 12.4072L14.875 16.5732C15.0684 16.7666 15.3232 16.8633 15.5957 16.8633C16.167 16.8633 16.5713 16.4238 16.5713 15.8613C16.5713 15.5977 16.4834 15.3516 16.29 15.1582L12.1504 11.0098C13.0205 9.86719 13.5391 8.45215 13.5391 6.91406C13.5391 3.19629 10.498 0.155273 6.78027 0.155273C3.0625 0.155273 0.0214844 3.19629 0.0214844 6.91406C0.0214844 10.6318 3.0625 13.6729 6.78027 13.6729ZM6.78027 12.2139C3.87988 12.2139 1.48047 9.81445 1.48047 6.91406C1.48047 4.01367 3.87988 1.61426 6.78027 1.61426C9.68066 1.61426 12.0801 4.01367 12.0801 6.91406C12.0801 9.81445 9.68066 12.2139 6.78027 12.2139Z"></path></svg>Search</div><div class="notion-focusable" role="button" style="user-select: none; transition: background 20ms ease-in 0s; cursor: pointer; display: inline-flex; align-items: center; flex-shrink: 0; white-space: nowrap; height: 28px; border-radius: 3px; font-size: 14px; line-height: 1.2; min-width: 0px; padding-left: 8px; padding-right: 8px; color: rgb(55, 53, 47);" tabindex="-1">Duplicate</div><div class="notion-focusable" role="button" style="user-select: none; transition: background 20ms ease-in 0s; cursor: pointer; display: flex; align-items: center; justify-content: center; width: 32px; height: 28px; border-radius: 3px;" tabindex="-1"><svg class="dots" style="width: 18px; height: 18px; display: block; fill: inherit; flex-shrink: 0; backface-visibility: hidden;" viewbox="0 0 13 3"><g> <path d="M3,1.5A1.5,1.5,0,1,1,1.5,0,1.5,1.5,0,0,1,3,1.5Z"></path> <path d="M8,1.5A1.5,1.5,0,1,1,6.5,0,1.5,1.5,0,0,1,8,1.5Z"></path> <path d="M13,1.5A1.5,1.5,0,1,1,11.5,0,1.5,1.5,0,0,1,13,1.5Z"></path> </g></svg></div><div style="flex: 0 0 auto; width: 1px; height: 16px; margin-left: 8px; margin-right: 8px; background: rgba(55, 53, 47, 0.16);"></div><div class="notion-focusable" role="button" style="user-select: none; transition: background 20ms ease-in 0s; cursor: pointer; display: inline-flex; align-items: center; flex-shrink: 0; white-space: nowrap; height: 28px; border-radius: 3px; font-size: 14px; line-height: 1.2; min-width: 0px; padding-left: 8px; padding-right: 8px; color: rgb(55, 53, 47);" tabindex="-1"><svg class="notionLogo" style="width: 18px; height: 18px; display: block; fill: inherit; flex-shrink: 0; backface-visibility: hidden; margin-right: 6px;" viewbox="0 0 120 126"><path d="M 20.6927 21.9315C 24.5836 25.0924 26.0432 24.8512 33.3492 24.3638L 102.228 20.2279C 103.689 20.2279 102.474 18.7705 101.987 18.5283L 90.5477 10.2586C 88.3558 8.55699 85.4356 6.60818 79.8387 7.09563L 13.1433 11.9602C 10.711 12.2014 10.2251 13.4175 11.1939 14.3924L 20.6927 21.9315ZM 24.8281 37.9835L 24.8281 110.456C 24.8281 114.351 26.7745 115.808 31.1553 115.567L 106.853 111.187C 111.236 110.946 111.724 108.267 111.724 105.103L 111.724 33.1169C 111.724 29.958 110.509 28.2544 107.826 28.4976L 28.721 33.1169C 25.8018 33.3622 24.8281 34.8225 24.8281 37.9835ZM 99.5567 41.8711C 100.042 44.0622 99.5567 46.2512 97.3618 46.4974L 93.7143 47.2241L 93.7143 100.728C 90.5477 102.43 87.6275 103.403 85.1942 103.403C 81.2983 103.403 80.3226 102.186 77.4044 98.54L 53.5471 61.087L 53.5471 97.3239L 61.0964 99.0275C 61.0964 99.0275 61.0964 103.403 55.0057 103.403L 38.2148 104.377C 37.727 103.403 38.2148 100.973 39.9179 100.486L 44.2996 99.2717L 44.2996 51.36L 38.2158 50.8725C 37.728 48.6815 38.9431 45.5225 42.3532 45.2773L 60.3661 44.0631L 85.1942 82.0036L 85.1942 48.4402L 78.864 47.7136C 78.3781 45.0351 80.3226 43.0902 82.7569 42.849L 99.5567 41.8711ZM 7.5434 5.39404L 76.9175 0.285276C 85.4366 -0.445402 87.6285 0.0440428 92.983 3.93368L 115.128 19.4982C 118.782 22.1747 120 22.9034 120 25.8211L 120 111.187C 120 116.537 118.051 119.701 111.237 120.185L 30.6734 125.05C 25.5584 125.294 23.124 124.565 20.4453 121.158L 4.13735 99.9994C 1.21516 96.1048 0 93.191 0 89.7819L 0 13.903C 0 9.5279 1.94945 5.8785 7.5434 5.39404Z"></path></svg>Notion</div></div></div><div style="width: 100%; user-select: none;"></div></div><div class="notion-scroller vertical horizontal" style="display: flex; flex-direction: column; z-index: 1; flex-grow: 1; position: relative; align-items: center; overflow: auto; margin-right: 0px; margin-bottom: 0px;"><div style="width: 100%; display: flex; flex-direction: column; align-items: center; flex-shrink: 0; flex-grow: 0;"><div style="padding-left: calc(96px + env(safe-area-inset-left)); padding-right: calc(96px + env(safe-area-inset-right)); max-width: 100%; width: 900px;"><div class="notion-page-controls" style='display: flex; justify-content: flex-start; flex-wrap: wrap; margin-top: 80px; margin-bottom: 4px; margin-left: -1px; color: rgba(55, 53, 47, 0.4); font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; height: 24px;'></div><div class="notion-selectable notion-page-block" data-block-id="4c5eb213-4ee1-435d-bd98-c4eac8334570" style='color: rgb(55, 53, 47); font-weight: 700; line-height: 1.2; font-size: 40px; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; cursor: text; display: flex; align-items: center;'><div class="" contenteditable="false" data-root="true" placeholder="Untitled" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>ubuntu16.04下ROS操作系统学习笔记（六 ）机器视觉-摄像头标定-ROS+OpenCv-人脸识别-物体跟踪-二维码识别 - 古月居</span></div></div></div></div><div style="width: 100%; display: flex; flex-direction: column; align-items: center; flex-shrink: 0; flex-grow: 0;"><div style="padding-left: calc(96px + env(safe-area-inset-left)); padding-right: calc(96px + env(safe-area-inset-right)); max-width: 100%; width: 900px;"><div class="notion-page-details-controls" style='display: flex; align-items: baseline; justify-content: flex-start; flex-wrap: wrap; color: rgba(55, 53, 47, 0.4); font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; padding-bottom: 20px;'></div></div></div><div class="notion-page-content" style="flex-shrink: 0; flex-grow: 1; width: 900px; max-width: 100%; display: flex; align-items: center; flex-direction: column; font-size: 16px; line-height: 1.5; padding-left: calc(96px + env(safe-area-inset-left)); padding-right: calc(96px + env(safe-area-inset-right)); padding-bottom: 30vh;"><div class="notion-selectable notion-text-block" data-block-id="1ff0a498-f0a8-4838-a649-e810b3a7770c" style="width: 100%; max-width: 1711px; margin-top: 2px; margin-bottom: 1px;"><div style="color: rgba(55, 53, 47, 0.6); fill: rgba(55, 53, 47, 0.6);"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><a class="notion-link-token notion-enable-hover" data-token-index="0" href="https://www.guyuehome.com/26665" rel="noopener noreferrer" style="cursor:pointer;color:inherit;word-wrap:break-word;text-decoration:inherit" target="_blank"><span style="border-bottom:0.05em solid;border-color:rgba(55,53,47,0.4);opacity:0.7"><span>https://www.guyuehome.com/26665</span></span></a></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="99c850d3-74fa-4f69-a3cd-1506452d6edb" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; min-height: 1em; color: rgb(55, 53, 47); -webkit-text-fill-color: rgba(55, 53, 47, 0.4);"></div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="38106821-e547-4df7-bc1a-dd9226545319" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div style="margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span>1.</span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;"><span>ROS中的图像数据。</span></div></div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="36fc7d9e-83b2-49c0-aab2-ff16375b0b82" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div style="margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span>2.</span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;"><span>摄像头标定。</span></div></div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="cc9876e8-32c5-40de-ac9d-4bf395e0dfd0" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div style="margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span>3.</span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;"><span>ROS+Opencv应用实例（人脸识别、物体跟踪）。</span></div></div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="8e549b40-171c-401a-97ae-9f500a2184ee" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div style="margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span>4.</span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;"><span>二维码识别。</span></div></div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="ccce8d2d-4f69-4995-be55-d9f749fa1fc3" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div style="margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span>5.</span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;"><span>扩展内容：物体识别与机器学习。</span></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="cf9b9e30-0624-4c74-834e-0ea1cc3c0f7f" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>启动摄像头：没有安装的话参照下面命令安装一下：</span></div></div></div></div><div class="notion-selectable notion-quote-block" data-block-id="9e42d4b9-dd6c-4baf-8272-6114aa0d6b49" style="width: 100%; max-width: 1711px; margin-top: 4px; margin-bottom: 4px;"><div style="font-size: 1.2em; padding: 3px 2px; color: inherit; fill: inherit; display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="Empty quote" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); border-left: 3px solid currentcolor; padding-left: 0.9em; padding-right: 0.9em;"><span>sudo apt-get install ros-kinetic-usb-cam</span></div></div></div><div class="notion-selectable notion-text-block" data-block-id="c9283beb-2f6b-496e-989a-ef5ac02694e1" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>安装完成之后就可以启动摄像头了：</span></div></div></div></div><div class="notion-selectable notion-quote-block" data-block-id="8186a913-c28e-4ac0-957a-5878ce09a471" style="width: 100%; max-width: 1711px; margin-top: 4px; margin-bottom: 4px;"><div style="font-size: 1.2em; padding: 3px 2px; color: inherit; fill: inherit; display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="Empty quote" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); border-left: 3px solid currentcolor; padding-left: 0.9em; padding-right: 0.9em;"><span>roslaunch usb_cam usb_cam-test.launch</span></div></div></div><div class="notion-selectable notion-image-block" data-block-id="70a892af-fa02-41f3-af7f-ac42665df327" style="width: 100%; max-width: 1903px; align-self: center; margin-top: 0.5em; margin-bottom: 0.5em;"><div><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div style="width: 100%; height: 100%;"><img src="3cb6c177f01008642b8cc33e76f7a1a1f5087045.png" style="display: block; object-fit: cover; border-radius: 1px; width: 100%; pointer-events: auto;"/></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="b4881a1d-225f-4e7a-8cee-8407f186ac90" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>我们接下来看一下这个摄像头的驱动到底发布了哪些数据：</span></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="99f4302d-cb23-4bcf-800a-004259c89c97" style="width: 100%; max-width: 1903px; align-self: center; margin-top: 0.5em; margin-bottom: 0.5em;"><div><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div style="width: 100%; height: 100%;"><img src="bae1a1a6eb00121e7b9d54ae05a303dab92b6c96.png" style="display: block; object-fit: cover; border-radius: 1px; width: 100%; pointer-events: auto;"/></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="23895a48-411e-430b-8584-9b631f09710d" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>我们刚才的摄像头就是usb_cam/image_raw这个话题，我们接下来看一下它发布的消息的具体类型：</span></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="d83af5ef-325f-4e80-814a-c76f59e43e82" style="width: 100%; max-width: 1903px; align-self: center; margin-top: 0.5em; margin-bottom: 0.5em;"><div><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div><img src="c6a606aeb2bf45508dd90827ce57d8662d747478.png" style="display: block; object-fit: cover; border-radius: 1px; background: white; width: 100%; pointer-events: auto;"/></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="c582fcf8-8f49-407d-bbcf-d5a6d8552dd2" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>第一行是这个话题消息的类型，从第一行可以看到，是sensor_msg这样一个类型。那这样一种图像消息里面的成员变量有哪些呢？通过以下命令我们可以打印出这样的一个消息类型里面的具体成员变量。</span></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="89c8996a-4856-43f6-85eb-b188cf5110fa" style="width: 100%; max-width: 1903px; align-self: center; margin-top: 0.5em; margin-bottom: 0.5em;"><div><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div style="width: 100%; height: 100%;"><img src="370b63df643b71ac5bedfd2aa138c9da9b0a3107.png" style="display: block; object-fit: cover; border-radius: 1px; width: 100%; pointer-events: auto;"/></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="451a9ea6-ec8c-43e6-987d-2f60294e8c1d" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>里面的具体的成员变量的解释如下：</span></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="8c58cd01-d526-4152-a0e4-896a35251f86" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div style="margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><div style="font-size: 1.5em; line-height: 1; margin-bottom: 0.1em;">•</div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;"><span>Header：很多话题消息里面都包含的。里面有三个内容：消息头，包含消息序号，时间戳和绑定坐标系。消息的序号表示我们这个消息发布是排第几位的，并不需要我们手动去标定，每次发布消息的时候会自动地去累加; 绑定坐标系表示的是我们是针对哪一个坐标系去发布的。header有时候也不需要去配置。</span></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="5f4cf572-13c3-41c2-a8a8-356a0ceeb6c5" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div style="margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><div style="font-size: 1.5em; line-height: 1; margin-bottom: 0.1em;">•</div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;"><span>height：图像的纵向分辨率</span></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="e6e87e8e-4c43-487f-a6f5-226fe8354399" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div style="margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><div style="font-size: 1.5em; line-height: 1; margin-bottom: 0.1em;">•</div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;"><span>width：图像的横向分辨率</span></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="530c7169-534a-4227-874d-c5da24df6fca" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div style="margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><div style="font-size: 1.5em; line-height: 1; margin-bottom: 0.1em;">•</div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;"><span>encoding：图像的编码格式，包含RGB、YUV等常用格式，都是原始图像的编码格式，不涉及图像压缩编码;</span></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="ef9b62a0-dbad-472a-864c-bba5988ee170" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div style="margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><div style="font-size: 1.5em; line-height: 1; margin-bottom: 0.1em;">•</div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;"><span>is_bigendian: 图像数据的大小端存储模式;</span></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="ae4a8b36-97f2-4f69-a006-de8f1a169ea2" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div style="margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><div style="font-size: 1.5em; line-height: 1; margin-bottom: 0.1em;">•</div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;"><span>step：一行图像数据的字节数量，作为数据的步长参数;</span></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="53dbf977-deb6-4a36-9b71-f326062e25e3" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div style="margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><div style="font-size: 1.5em; line-height: 1; margin-bottom: 0.1em;">•</div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;"><span>data：存储图像数据的数组，大小为step×height个字节。</span></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="5028a190-d8c7-4807-9873-493653d704cd" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>在ros里面提供了我们另外一种压缩图像的类型，</span></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="74d2f342-0a56-4784-b629-23738e741ced" style="width: 100%; max-width: 1903px; align-self: center; margin-top: 0.5em; margin-bottom: 0.5em;"><div><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div><img src="09c46fb78bedc38ae52357fffd5c106f0c5a6ea9.png" style="display: block; object-fit: cover; border-radius: 1px; background: white; width: 100%; pointer-events: auto;"/></div></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="c5b3576a-c473-484f-a9b3-ed3f9bab5963" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div style="margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><div style="font-size: 1.5em; line-height: 1; margin-bottom: 0.1em;">•</div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;"><span>format：图像的压缩编码格式（jpeg、png、bmp）。</span></div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="75b0ff06-d578-4b97-b8fb-987c6fdb14a7" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div style="margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><div style="font-size: 1.5em; line-height: 1; margin-bottom: 0.1em;">•</div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;"><span>data：存储图像数据数组。</span></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="f13ead78-c6a6-4970-8c99-98fbe3c3398a" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>原教学视频里面还说了深度摄像头的相关知识，我这里没有深度摄像头，所以有需要的可以自己去看源视频，在我的github里面可以找到视频的相关信息。</span></div></div></div></div><div class="notion-selectable notion-sub_sub_header-block" data-block-id="ebef1950-b6c3-440d-ad03-948fe4601bf5" style="width: 100%; max-width: 1711px; margin-top: 1em; margin-bottom: 1px;"><div style='display: flex; width: 100%; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; font-weight: 600; font-size: 1.25em; line-height: 1.3; color: inherit; fill: inherit;'><div class="" contenteditable="false" data-root="true" placeholder="Heading 3" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span data-token-index="0" style="font-weight:600"><span>摄像头标定</span></span></div></div></div><div class="notion-selectable notion-text-block" data-block-id="10da653c-2388-4d97-b327-e920dad74750" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>摄像头这种精密仪器对光学器件的要求较高，由于摄像头内部与外部的一些原因，生成的物体图像往往会发生畸变，为避免数据源造成的误差，需要针对摄像头的参数进行标定。   为了保证我们图像的质量，在采集图像之前，我们需要对摄像头做标定。   安装标定功能包：</span></div></div></div></div><div class="notion-selectable notion-quote-block" data-block-id="4c65a5e7-69d8-4f05-a420-0d6b00531674" style="width: 100%; max-width: 1711px; margin-top: 4px; margin-bottom: 4px;"><div style="font-size: 1.2em; padding: 3px 2px; color: inherit; fill: inherit; display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="Empty quote" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); border-left: 3px solid currentcolor; padding-left: 0.9em; padding-right: 0.9em;"><span>sudo apt-get install ros-kinetic-camera-calibration</span></div></div></div><div class="notion-selectable notion-text-block" data-block-id="617a37b2-12a4-418a-ad7b-5bf78d004579" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>启动摄像头，robot_vision这个包在第五讲的源代码包里面有。</span></div></div></div></div><div class="notion-selectable notion-code-block" data-block-id="08e0f319-7ceb-452a-a60f-52c8da77cb27" style="width: 100%; max-width: 1711px; margin-top: 4px; margin-bottom: 4px;"><div style="display: flex;"><div style="flex-grow: 1; border-radius: 3px; text-align: left; position: relative; background: rgb(247, 246, 243); min-width: 0px; width: 100%;"><div class="line-numbers notion-code-block" style="display: flex;"><div autocapitalize="off" autocorrect="off" class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: left; font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, Courier, monospace; font-size: 85%; tab-size: 2; padding: 34px 16px 32px 32px; min-height: 1em; color: rgb(55, 53, 47); white-space: pre-wrap; word-break: break-all; min-width: 0px;'><span>roslaunch robot_vision usb_cam.launch</span></div></div><div style="position: absolute; top: 3px; right: 1px; color: rgba(55, 53, 47, 0.6); display: flex; align-items: center; justify-content: flex-end; height: 25px; font-size: 11.5px; opacity: 0; transition: opacity 300ms ease-in 0s;"></div><div style="position: absolute; top: 8px; left: 8px; color: rgba(55, 53, 47, 0.6); display: flex; align-items: center; justify-content: flex-end; opacity: 0; transition: opacity 300ms ease-in 0s;"><div aria-disabled="true" class="notion-focusable" role="button" style="user-select: none; transition: background 20ms ease-in 0s; display: inline-flex; align-items: center; white-space: nowrap; height: 20px; border-radius: 3px; font-size: 12px; line-height: 1.2; padding-left: 5px; padding-right: 5px; color: rgba(55, 53, 47, 0.6); margin-right: 5px;" tabindex="-1">Plain Text<svg class="chevronDown" style="width: 10px; height: 100%; display: block; fill: rgba(55, 53, 47, 0.3); flex-shrink: 0; backface-visibility: hidden; margin-left: 4px;" viewbox="0 0 30 30"><polygon points="15,17.4 4.8,7 2,9.8 15,23 28,9.8 25.2,7 "></polygon></svg></div></div><div style="background: white; padding-right: 105px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="1cc1e363-e298-400b-8334-e20c0d72b0b7" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>启动成功之后没有摄像头的界面，因为包里面是没有去打开摄像头的：</span></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="cdfc79d2-aac9-404b-a23d-a1825daec830" style="width: 100%; max-width: 1903px; align-self: center; margin-top: 0.5em; margin-bottom: 0.5em;"><div><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div style="width: 100%; height: 100%;"><img src="391b8f3982e3c34383b8d47c48fd493ed9d1de93.png" style="display: block; object-fit: cover; border-radius: 1px; width: 100%; pointer-events: auto;"/></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="54c88c28-3b42-4448-ad7c-b1b979cf9f8a" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>启动标定包：</span></div></div></div></div><div class="notion-selectable notion-code-block" data-block-id="7aa18055-a35f-44a4-9801-98296b0b14bf" style="width: 100%; max-width: 1711px; margin-top: 4px; margin-bottom: 4px;"><div style="display: flex;"><div style="flex-grow: 1; border-radius: 3px; text-align: left; position: relative; background: rgb(247, 246, 243); min-width: 0px; width: 100%;"><div class="line-numbers notion-code-block" style="display: flex;"><div autocapitalize="off" autocorrect="off" class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: left; font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, Courier, monospace; font-size: 85%; tab-size: 2; padding: 34px 16px 32px 32px; min-height: 1em; color: rgb(55, 53, 47); white-space: pre-wrap; word-break: break-all; min-width: 0px;'><span>rosrun camera_calibration cameracalibrator.py  --size 8x6 --square 0.024 image:=/usb_cam/image_raw camera:=/usb_cam</span></div></div><div style="position: absolute; top: 3px; right: 1px; color: rgba(55, 53, 47, 0.6); display: flex; align-items: center; justify-content: flex-end; height: 25px; font-size: 11.5px; opacity: 0; transition: opacity 300ms ease-in 0s;"></div><div style="position: absolute; top: 8px; left: 8px; color: rgba(55, 53, 47, 0.6); display: flex; align-items: center; justify-content: flex-end; opacity: 0; transition: opacity 300ms ease-in 0s;"><div aria-disabled="true" class="notion-focusable" role="button" style="user-select: none; transition: background 20ms ease-in 0s; display: inline-flex; align-items: center; white-space: nowrap; height: 20px; border-radius: 3px; font-size: 12px; line-height: 1.2; padding-left: 5px; padding-right: 5px; color: rgba(55, 53, 47, 0.6); margin-right: 5px;" tabindex="-1">Plain Text<svg class="chevronDown" style="width: 10px; height: 100%; display: block; fill: rgba(55, 53, 47, 0.3); flex-shrink: 0; backface-visibility: hidden; margin-left: 4px;" viewbox="0 0 30 30"><polygon points="15,17.4 4.8,7 2,9.8 15,23 28,9.8 25.2,7 "></polygon></svg></div></div><div style="background: white; padding-right: 105px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="6c141de9-6f37-4f89-815e-ab8dc526eb57" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>以上程序就会启动我们标定功能包的一个标定程序。</span></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="3ad67fe9-b40e-41d6-b41e-8cf44b5ade90" style="width: 100%; max-width: 1903px; align-self: center; margin-top: 0.5em; margin-bottom: 0.5em;"><div><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div><img src="8edce1896db9306f305ee1e4e2471a4a3d5ef9b4.png" style="display: block; object-fit: cover; border-radius: 1px; background: white; width: 100%; pointer-events: auto;"/></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="f3da1e88-1f29-4d37-8f9a-38a259875782" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>然后我们打开在功能包里面的doc文件，就可以看到这样一个黑白相见的图片，然后我们做旋转等等操作，移动几遍，标定好了之后如下图所示：</span></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="7fd37143-4f44-4311-9432-90c3b5663a9d" style="width: 100%; max-width: 1903px; align-self: center; margin-top: 0.5em; margin-bottom: 0.5em;"><div><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div style="width: 100%; height: 100%;"><img src="3d504887883903d3785db53069f2ede20b8ec934.png" style="display: block; object-fit: cover; border-radius: 1px; width: 100%; pointer-events: auto;"/></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="5c23f14c-d22e-4d41-8646-f67b00d5b141" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>标定成功之后会显示灰绿色的这个按钮颜色。之后我们再点击这个绿色的按钮，然后图形将该会卡住，在后台做一些计算，运行一会之后就能看到如下效果：</span></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="99fed705-d0c7-4d7b-97b8-624e60902cb1" style="width: 100%; max-width: 1903px; align-self: center; margin-top: 0.5em; margin-bottom: 0.5em;"><div><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div style="width: 100%; height: 100%;"><img src="05bcab808c16789e133a62eb0cc63a8e0ea057cc.png" style="display: block; object-fit: cover; border-radius: 1px; width: 100%; pointer-events: auto;"/></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="246f4415-5e21-43ff-8885-4aff9f017cc3" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>我们接着点击save按钮。之后在终端里面会告诉我们标定的数据存放在哪个路径下面：</span></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="0fa8471e-d3cd-4cf4-bae0-270c3405a5a3" style="width: 100%; max-width: 1903px; align-self: center; margin-top: 0.5em; margin-bottom: 0.5em;"><div><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div style="width: 100%; height: 100%;"><img src="8dbba4c54d24d4f8359843a61b945f87aec5a179.png" style="display: block; object-fit: cover; border-radius: 1px; width: 100%; pointer-events: auto;"/></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="56b244aa-4de8-4584-8eb0-f0c2a1b2c8d3" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>到此，标定就已经结束了。   rosrun camera_calibration cameracalibrator.py  --size 8x6 --square 0.024 image:=/usb_cam/image_raw camera:=/usb_cam</span></div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="9c268012-de22-47ed-8365-838341e499a0" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div style="margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span>1.</span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;"><span>size：标定棋盘格的内部角点个数，这里使用的棋盘一共有六行，内部8个角点;</span></div></div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="10c42b76-8016-4dd6-acda-0d47fe1efd5c" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div style="margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span>2.</span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;"><span>square：这个参数对应每个棋盘的边长，单位是米;</span></div></div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="7afb692c-b96a-4ad3-bcbd-25b4e1b871eb" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div style="margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span>3.</span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;"><span>image和camera：设置摄像头发布的图像话题。</span></div></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="d83a6827-2f02-4132-84d4-157c78044175" style="width: 100%; max-width: 1903px; align-self: center; margin-top: 0.5em; margin-bottom: 0.5em;"><div><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div><img src="51692f8c6fb66ae489dc6957ce0ed8267606ffe2.png" style="display: block; object-fit: cover; border-radius: 1px; background: white; width: 100%; pointer-events: auto;"/></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="ef2134e1-13ad-41a7-87e2-59bd382d4128" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>我们找到刚刚产生的文件，将其解压缩，如下图所示：</span></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="26b95617-09aa-4bdd-b1e5-4103c5e1a111" style="width: 100%; max-width: 1903px; align-self: center; margin-top: 0.5em; margin-bottom: 0.5em;"><div><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div><img src="1b980e57520ce4ca38ee6badd839b91743b00ed9.png" style="display: block; object-fit: cover; border-radius: 1px; background: white; width: 100%; pointer-events: auto;"/></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="497ea1cd-3b03-44d2-9e61-b957c2daa670" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>然后里面有用的文件是 ost.yaml。然后放入我们的功能包，并将其重命名就可以了：</span></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="7049f1d9-4c33-426e-b3eb-fcc7f9d2beee" style="width: 100%; max-width: 1903px; align-self: center; margin-top: 0.5em; margin-bottom: 0.5em;"><div><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div style="width: 100%; height: 100%;"><img src="5173b053f044085a2213c563030f61c63a6f72f5.png" style="display: block; object-fit: cover; border-radius: 1px; width: 100%; pointer-events: auto;"/></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="f080d322-af46-4e34-8a64-22e9527d58af" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span data-token-index="0" style="font-weight:600"><span>Kinetic标定：</span></span></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="a1f58002-ca22-4d41-8a1f-e17ba393dcce" style="width: 100%; max-width: 1903px; align-self: center; margin-top: 0.5em; margin-bottom: 0.5em;"><div><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div><img src="7d2043332ba1cd52d76774644fc2d6f6291060c6.png" style="display: block; object-fit: cover; border-radius: 1px; background: white; width: 100%; pointer-events: auto;"/></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="ecdc428e-e22a-40b4-ba31-c4a873a5c41a" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>之后的操作都类似，具体可以参考原视频。</span></div></div></div></div><div class="notion-selectable notion-sub_sub_header-block" data-block-id="3d1ccc4d-136b-455d-a754-0c93e5ffc342" style="width: 100%; max-width: 1711px; margin-top: 1em; margin-bottom: 1px;"><div style='display: flex; width: 100%; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; font-weight: 600; font-size: 1.25em; line-height: 1.3; color: inherit; fill: inherit;'><div class="" contenteditable="false" data-root="true" placeholder="Heading 3" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span data-token-index="0" style="font-weight:600"><span>Opencv</span></span></div></div></div><div class="notion-selectable notion-text-block" data-block-id="e9ed70fa-2c3a-4588-8e6a-b6a7f8934ec3" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span data-token-index="0" style="font-weight:600"><span>Open Source Computer Vision Library</span></span></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="834bd6a8-f7e7-4f10-aee6-b9abac662683" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>在ROS当中完成Opencv的安装：</span></div></div></div></div><div class="notion-selectable notion-code-block" data-block-id="3cc585b3-d48b-4bd4-b54d-4324dd1b338e" style="width: 100%; max-width: 1711px; margin-top: 4px; margin-bottom: 4px;"><div style="display: flex;"><div style="flex-grow: 1; border-radius: 3px; text-align: left; position: relative; background: rgb(247, 246, 243); min-width: 0px; width: 100%;"><div class="line-numbers notion-code-block" style="display: flex;"><div autocapitalize="off" autocorrect="off" class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: left; font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, Courier, monospace; font-size: 85%; tab-size: 2; padding: 34px 16px 32px 32px; min-height: 1em; color: rgb(55, 53, 47); white-space: pre-wrap; word-break: break-all; min-width: 0px;'><span>sudo apt-get install ros-kinetic-vision-opencv libopencv-dev python-opencv</span></div></div><div style="position: absolute; top: 3px; right: 1px; color: rgba(55, 53, 47, 0.6); display: flex; align-items: center; justify-content: flex-end; height: 25px; font-size: 11.5px; opacity: 0; transition: opacity 300ms ease-in 0s;"></div><div style="position: absolute; top: 8px; left: 8px; color: rgba(55, 53, 47, 0.6); display: flex; align-items: center; justify-content: flex-end; opacity: 0; transition: opacity 300ms ease-in 0s;"><div aria-disabled="true" class="notion-focusable" role="button" style="user-select: none; transition: background 20ms ease-in 0s; display: inline-flex; align-items: center; white-space: nowrap; height: 20px; border-radius: 3px; font-size: 12px; line-height: 1.2; padding-left: 5px; padding-right: 5px; color: rgba(55, 53, 47, 0.6); margin-right: 5px;" tabindex="-1">Plain Text<svg class="chevronDown" style="width: 10px; height: 100%; display: block; fill: rgba(55, 53, 47, 0.3); flex-shrink: 0; backface-visibility: hidden; margin-left: 4px;" viewbox="0 0 30 30"><polygon points="15,17.4 4.8,7 2,9.8 15,23 28,9.8 25.2,7 "></polygon></svg></div></div><div style="background: white; padding-right: 105px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="af7c88f3-99b8-42c0-8e8b-a35e9b34b134" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>ROS与Opencv之间的数据连接是通过CvBridge来实现的。ROS Image Message与OpenCv Ipllmage之间连接的一个桥。   接下来我们测试一下：</span></div></div></div></div><div class="notion-selectable notion-code-block" data-block-id="3ddc981f-5e3d-44fb-8b01-181960f98adb" style="width: 100%; max-width: 1711px; margin-top: 4px; margin-bottom: 4px;"><div style="display: flex;"><div style="flex-grow: 1; border-radius: 3px; text-align: left; position: relative; background: rgb(247, 246, 243); min-width: 0px; width: 100%;"><div class="line-numbers notion-code-block" style="display: flex;"><div autocapitalize="off" autocorrect="off" class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: left; font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, Courier, monospace; font-size: 85%; tab-size: 2; padding: 34px 16px 32px 32px; min-height: 1em; color: rgb(55, 53, 47); white-space: pre-wrap; word-break: break-all; min-width: 0px;'><span>roslaunch robot_vision usb_cam.launch</span></div></div><div style="position: absolute; top: 3px; right: 1px; color: rgba(55, 53, 47, 0.6); display: flex; align-items: center; justify-content: flex-end; height: 25px; font-size: 11.5px; opacity: 0; transition: opacity 300ms ease-in 0s;"></div><div style="position: absolute; top: 8px; left: 8px; color: rgba(55, 53, 47, 0.6); display: flex; align-items: center; justify-content: flex-end; opacity: 0; transition: opacity 300ms ease-in 0s;"><div aria-disabled="true" class="notion-focusable" role="button" style="user-select: none; transition: background 20ms ease-in 0s; display: inline-flex; align-items: center; white-space: nowrap; height: 20px; border-radius: 3px; font-size: 12px; line-height: 1.2; padding-left: 5px; padding-right: 5px; color: rgba(55, 53, 47, 0.6); margin-right: 5px;" tabindex="-1">Plain Text<svg class="chevronDown" style="width: 10px; height: 100%; display: block; fill: rgba(55, 53, 47, 0.3); flex-shrink: 0; backface-visibility: hidden; margin-left: 4px;" viewbox="0 0 30 30"><polygon points="15,17.4 4.8,7 2,9.8 15,23 28,9.8 25.2,7 "></polygon></svg></div></div><div style="background: white; padding-right: 105px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="ac90cae4-2804-40cb-9b1c-4faee1a10f50" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>这个命令运行完之后是没有结果输出的，我们之后再启动节点：</span></div></div></div></div><div class="notion-selectable notion-code-block" data-block-id="ffaf35f8-d408-4954-83ea-88787490730f" style="width: 100%; max-width: 1711px; margin-top: 4px; margin-bottom: 4px;"><div style="display: flex;"><div style="flex-grow: 1; border-radius: 3px; text-align: left; position: relative; background: rgb(247, 246, 243); min-width: 0px; width: 100%;"><div class="line-numbers notion-code-block" style="display: flex;"><div autocapitalize="off" autocorrect="off" class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: left; font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, Courier, monospace; font-size: 85%; tab-size: 2; padding: 34px 16px 32px 32px; min-height: 1em; color: rgb(55, 53, 47); white-space: pre-wrap; word-break: break-all; min-width: 0px;'><span>rosrun robot_vision cv_bridge_test.py</span></div></div><div style="position: absolute; top: 3px; right: 1px; color: rgba(55, 53, 47, 0.6); display: flex; align-items: center; justify-content: flex-end; height: 25px; font-size: 11.5px; opacity: 0; transition: opacity 300ms ease-in 0s;"></div><div style="position: absolute; top: 8px; left: 8px; color: rgba(55, 53, 47, 0.6); display: flex; align-items: center; justify-content: flex-end; opacity: 0; transition: opacity 300ms ease-in 0s;"><div aria-disabled="true" class="notion-focusable" role="button" style="user-select: none; transition: background 20ms ease-in 0s; display: inline-flex; align-items: center; white-space: nowrap; height: 20px; border-radius: 3px; font-size: 12px; line-height: 1.2; padding-left: 5px; padding-right: 5px; color: rgba(55, 53, 47, 0.6); margin-right: 5px;" tabindex="-1">Plain Text<svg class="chevronDown" style="width: 10px; height: 100%; display: block; fill: rgba(55, 53, 47, 0.3); flex-shrink: 0; backface-visibility: hidden; margin-left: 4px;" viewbox="0 0 30 30"><polygon points="15,17.4 4.8,7 2,9.8 15,23 28,9.8 25.2,7 "></polygon></svg></div></div><div style="background: white; padding-right: 105px;"></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="1f3c2c09-50fe-4963-8ba6-26f86b976ed4" style="width: 100%; max-width: 1903px; align-self: center; margin-top: 0.5em; margin-bottom: 0.5em;"><div><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div><img src="c0209851989f10e3984caa2c061e9e86b02b8283.png" style="display: block; object-fit: cover; border-radius: 1px; background: white; width: 100%; pointer-events: auto;"/></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="314786f7-acb7-4df6-8263-d76c92e4a53d" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>再打开ROS测试：</span></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="0b92b8f8-0269-4c19-88eb-f8dac0b7015e" style="width: 100%; max-width: 1903px; align-self: center; margin-top: 0.5em; margin-bottom: 0.5em;"><div><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div><img src="4abd959721cb537e7c0f494f162d97127f6a374e.png" style="display: block; object-fit: cover; border-radius: 1px; background: white; width: 100%; pointer-events: auto;"/></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="84881c43-7d1f-41b7-bdb9-51096e331138" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>显示成功之后表示测试没有问题。   第一张图片显示的是opencv的图像，是经过opencv的接口，与ros没有关系。而第二张图片是通过ros当中订阅话题来显示的。首先是在ros当中启动了一个节点，那么发布的消息也是ros消息的这种类型，然后通过bridge转接到了opencv系统，然后在opencv里面完成一些处理，像在左上角画出一个圈，并且把处理的图片通过opencv显示出来，再通过bridge发回到ros系统里面，ros再订阅这个话题就可以了。   我们可以看一下 刚刚的命令-《 rosrun robot_vision cv_bridge_test.py 》启动的这个节点：</span></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="4b9a9786-ad2f-49b2-925c-3d8bc9a2816d" style="width: 100%; max-width: 1903px; align-self: center; margin-top: 0.5em; margin-bottom: 0.5em;"><div><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div><img src="5ffb1a1c711eb9134fb5cac621fdb50b970fbc0b.png" style="display: block; object-fit: cover; border-radius: 1px; background: white; width: 100%; pointer-events: auto;"/></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="ba31849c-01d2-47b0-9942-044850f6ff64" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>我们首先看一下main函数：</span></div></div></div></div><div class="notion-selectable notion-code-block" data-block-id="69d6ddc0-fd03-4320-9770-2ea04d7e21e3" style="width: 100%; max-width: 1711px; margin-top: 4px; margin-bottom: 4px;"><div style="display: flex;"><div style="flex-grow: 1; border-radius: 3px; text-align: left; position: relative; background: rgb(247, 246, 243); min-width: 0px; width: 100%;"><div class="line-numbers notion-code-block" style="display: flex;"><div autocapitalize="off" autocorrect="off" class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: left; font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, Courier, monospace; font-size: 85%; tab-size: 2; padding: 34px 16px 32px 32px; min-height: 1em; color: rgb(55, 53, 47); white-space: pre-wrap; word-break: break-all; min-width: 0px;'><span class="token keyword" data-token-index="0">if</span><span data-token-index="0"> __name__ </span><span class="token operator" data-token-index="0">==</span><span data-token-index="0"> </span><span class="token string" data-token-index="0">'__main__'</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">try</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># 初始化ros节点</span><span data-token-index="0">
        rospy</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">init_node</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">"cv_bridge_test"</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
        rospy</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">loginfo</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">"Starting cv_bridge_test node"</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
        image_converter</span><span class="token punctuation" data-token-index="0">(</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
        rospy</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">spin</span><span class="token punctuation" data-token-index="0">(</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">except</span><span data-token-index="0"> KeyboardInterrupt</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">print</span><span data-token-index="0"> </span><span class="token string" data-token-index="0">"Shutting down cv_bridge_test node."</span><span data-token-index="0">
        cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">destroyAllWindows</span><span class="token punctuation" data-token-index="0">(</span><span class="token punctuation" data-token-index="0">)</span><span>
</span></div></div><div style="position: absolute; top: 3px; right: 1px; color: rgba(55, 53, 47, 0.6); display: flex; align-items: center; justify-content: flex-end; height: 25px; font-size: 11.5px; opacity: 0; transition: opacity 300ms ease-in 0s;"></div><div style="position: absolute; top: 8px; left: 8px; color: rgba(55, 53, 47, 0.6); display: flex; align-items: center; justify-content: flex-end; opacity: 0; transition: opacity 300ms ease-in 0s;"><div aria-disabled="true" class="notion-focusable" role="button" style="user-select: none; transition: background 20ms ease-in 0s; display: inline-flex; align-items: center; white-space: nowrap; height: 20px; border-radius: 3px; font-size: 12px; line-height: 1.2; padding-left: 5px; padding-right: 5px; color: rgba(55, 53, 47, 0.6); margin-right: 5px;" tabindex="-1">Python<svg class="chevronDown" style="width: 10px; height: 100%; display: block; fill: rgba(55, 53, 47, 0.3); flex-shrink: 0; backface-visibility: hidden; margin-left: 4px;" viewbox="0 0 30 30"><polygon points="15,17.4 4.8,7 2,9.8 15,23 28,9.8 25.2,7 "></polygon></svg></div></div><div style="background: white; padding-right: 105px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="58e0da31-cd83-46c6-b013-a2982762d3ba" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>在main函数里面，第一行我们初始化这个节点，第二行输出这个节点的日志信息，第三行调用图像转换函数，第四行通过spin等待回调函数。   之后看一下image_converter类函数。</span></div></div></div></div><div class="notion-selectable notion-code-block" data-block-id="41f3fd58-ae84-4d3d-ae16-53ee56ade43b" style="width: 100%; max-width: 1711px; margin-top: 4px; margin-bottom: 4px;"><div style="display: flex;"><div style="flex-grow: 1; border-radius: 3px; text-align: left; position: relative; background: rgb(247, 246, 243); min-width: 0px; width: 100%;"><div class="line-numbers notion-code-block" style="display: flex;"><div autocapitalize="off" autocorrect="off" class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: left; font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, Courier, monospace; font-size: 85%; tab-size: 2; padding: 34px 16px 32px 32px; min-height: 1em; color: rgb(55, 53, 47); white-space: pre-wrap; word-break: break-all; min-width: 0px;'><span class="token keyword" data-token-index="0">class</span><span data-token-index="0"> </span><span class="token class-name" data-token-index="0">image_converter</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">def</span><span data-token-index="0"> </span><span class="token function" data-token-index="0">__init__</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">self</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># 创建cv_bridge，声明图像的发布者和订阅者</span><span data-token-index="0">
        self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">image_pub </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> rospy</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">Publisher</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">"cv_bridge_image"</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> Image</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> queue_size</span><span class="token operator" data-token-index="0">=</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
        self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">bridge </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> CvBridge</span><span class="token punctuation" data-token-index="0">(</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
        self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">image_sub </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> rospy</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">Subscriber</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">"/usb_cam/image_raw"</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> Image</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">callback</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">def</span><span data-token-index="0"> </span><span class="token function" data-token-index="0">callback</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">self</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0">data</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># 使用cv_bridge将ROS的图像数据转换成OpenCV的图像格式</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">try</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
            cv_image </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">bridge</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">imgmsg_to_cv2</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">data</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token string" data-token-index="0">"bgr8"</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">except</span><span data-token-index="0"> CvBridgeError </span><span class="token keyword" data-token-index="0">as</span><span data-token-index="0"> e</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">print</span><span data-token-index="0"> e
        </span><span class="token comment" data-token-index="0"># 在opencv的显示窗口中绘制一个圆，作为标记</span><span data-token-index="0">
</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">rows</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0">cols</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0">channels</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0"> </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> cv_image</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">shape
        </span><span class="token keyword" data-token-index="0">if</span><span data-token-index="0"> cols </span><span class="token operator" data-token-index="0">&gt;</span><span data-token-index="0"> </span><span class="token number" data-token-index="0">60</span><span data-token-index="0"> </span><span class="token keyword" data-token-index="0">and</span><span data-token-index="0"> rows </span><span class="token operator" data-token-index="0">&gt;</span><span data-token-index="0"> </span><span class="token number" data-token-index="0">60</span><span data-token-index="0"> </span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
            cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">circle</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">cv_image</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token punctuation" data-token-index="0">(</span><span class="token number" data-token-index="0">60</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token number" data-token-index="0">60</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token number" data-token-index="0">30</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token punctuation" data-token-index="0">(</span><span class="token number" data-token-index="0">0</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">0</span><span class="token punctuation" data-token-index="0">,</span><span class="token number" data-token-index="0">255</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token operator" data-token-index="0">-</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># 显示Opencv格式的图像</span><span data-token-index="0">
        cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">imshow</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">"Image window"</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> cv_image</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
        cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">waitKey</span><span class="token punctuation" data-token-index="0">(</span><span class="token number" data-token-index="0">3</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># 再将opencv格式额数据转换成ros image格式的数据发布</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">try</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
            self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">image_pub</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">publish</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">bridge</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">cv2_to_imgmsg</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">cv_image</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token string" data-token-index="0">"bgr8"</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">except</span><span data-token-index="0"> CvBridgeError </span><span class="token keyword" data-token-index="0">as</span><span data-token-index="0"> e</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">print</span><span data-token-index="0"> e</span><span>
</span></div></div><div style="position: absolute; top: 3px; right: 1px; color: rgba(55, 53, 47, 0.6); display: flex; align-items: center; justify-content: flex-end; height: 25px; font-size: 11.5px; opacity: 0; transition: opacity 300ms ease-in 0s;"></div><div style="position: absolute; top: 8px; left: 8px; color: rgba(55, 53, 47, 0.6); display: flex; align-items: center; justify-content: flex-end; opacity: 0; transition: opacity 300ms ease-in 0s;"><div aria-disabled="true" class="notion-focusable" role="button" style="user-select: none; transition: background 20ms ease-in 0s; display: inline-flex; align-items: center; white-space: nowrap; height: 20px; border-radius: 3px; font-size: 12px; line-height: 1.2; padding-left: 5px; padding-right: 5px; color: rgba(55, 53, 47, 0.6); margin-right: 5px;" tabindex="-1">Python<svg class="chevronDown" style="width: 10px; height: 100%; display: block; fill: rgba(55, 53, 47, 0.3); flex-shrink: 0; backface-visibility: hidden; margin-left: 4px;" viewbox="0 0 30 30"><polygon points="15,17.4 4.8,7 2,9.8 15,23 28,9.8 25.2,7 "></polygon></svg></div></div><div style="background: white; padding-right: 105px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="f5a7989c-583c-4802-aefc-ddc4b0e1e9c5" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>在这个类的初始化里面，声明了一个发布者和一个订阅者。订阅者订阅的是usb摄像头发布的话题“”/usb_cam/image_raw“，后面还有一个callback函数。发布者发布的是最终经过opencv处理之后的图像，也就是我们之前在rqt工具里面看到的图像 ”cv_bridge_image“。之后还调用了一下CvBridge。self.bridge = CvBridge()。   订阅者接收到图像之后就调用回调函数callback： 在callback函数里面，我们将从ros中接收到的图片数据转换为opencv能够读取的格式。通过调用CvBridge函数就可以实现上述功能，最终的cv_image就是opencv能够去处理的格式。之后我们使用opencv函数里面的一些函数cv2.circle去绘制圆。然后将其显示出来。之后我们再通过bridge.cv2_to_imgmsg将其转换为ros系统的数据格式，再将其发布出去。   这里的话需要重点去知道两个函数： imgmsg_to_cv2():将ros图像消息转换成OpenCv图像数据; cv2_to_imgmsg():将OpenCv格式的图像数据转换成ros图像消息;</span></div></div></div></div><div class="notion-selectable notion-sub_sub_header-block" data-block-id="d4bc37ff-168f-4b09-960d-d62ac94da017" style="width: 100%; max-width: 1711px; margin-top: 1em; margin-bottom: 1px;"><div style='display: flex; width: 100%; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; font-weight: 600; font-size: 1.25em; line-height: 1.3; color: inherit; fill: inherit;'><div class="" contenteditable="false" data-root="true" placeholder="Heading 3" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span data-token-index="0" style="font-weight:600"><span>人脸检测</span></span></div></div></div><div class="notion-selectable notion-text-block" data-block-id="fac9002a-0090-4123-863c-f6501eec1bc3" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>基于Haar特征的级联分类器检测算法主要步骤：</span></div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="6795d044-c922-4600-a60c-4f371c9eb661" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div style="margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span>1.</span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;"><span>灰阶色彩转换</span></div></div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="04ac0359-e9cd-477b-b004-203181bd26d4" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div style="margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span>2.</span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;"><span>缩小摄像头图像</span></div></div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="39bc33b8-3e97-4f1b-a5c2-fa596aa30760" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div style="margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span>3.</span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;"><span>直方图均衡化</span></div></div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="55384448-1176-459c-beee-fe338161e44f" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div style="margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span>4.</span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;"><span>检测人脸</span></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="4a6096a5-67a8-4faa-a851-860ac2afc7db" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>代码文件以及视频解释等相关文件在我github里面都可以去找到，这里不方便贴出来。分别在三个终端运行以下命令：</span></div></div></div></div><div class="notion-selectable notion-code-block" data-block-id="90c57079-4f21-4e2f-80b2-ca3cb9fab6f4" style="width: 100%; max-width: 1711px; margin-top: 4px; margin-bottom: 4px;"><div style="display: flex;"><div style="flex-grow: 1; border-radius: 3px; text-align: left; position: relative; background: rgb(247, 246, 243); min-width: 0px; width: 100%;"><div class="line-numbers notion-code-block" style="display: flex;"><div autocapitalize="off" autocorrect="off" class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: left; font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, Courier, monospace; font-size: 85%; tab-size: 2; padding: 34px 16px 32px 32px; min-height: 1em; color: rgb(55, 53, 47); white-space: pre-wrap; word-break: break-all; min-width: 0px;'><span>roslaunch robot_vision usb_cam.launch
roslaunch robot_vision face_detector.launch
rqt_image_view</span></div></div><div style="position: absolute; top: 3px; right: 1px; color: rgba(55, 53, 47, 0.6); display: flex; align-items: center; justify-content: flex-end; height: 25px; font-size: 11.5px; opacity: 0; transition: opacity 300ms ease-in 0s;"></div><div style="position: absolute; top: 8px; left: 8px; color: rgba(55, 53, 47, 0.6); display: flex; align-items: center; justify-content: flex-end; opacity: 0; transition: opacity 300ms ease-in 0s;"><div aria-disabled="true" class="notion-focusable" role="button" style="user-select: none; transition: background 20ms ease-in 0s; display: inline-flex; align-items: center; white-space: nowrap; height: 20px; border-radius: 3px; font-size: 12px; line-height: 1.2; padding-left: 5px; padding-right: 5px; color: rgba(55, 53, 47, 0.6); margin-right: 5px;" tabindex="-1">Plain Text<svg class="chevronDown" style="width: 10px; height: 100%; display: block; fill: rgba(55, 53, 47, 0.3); flex-shrink: 0; backface-visibility: hidden; margin-left: 4px;" viewbox="0 0 30 30"><polygon points="15,17.4 4.8,7 2,9.8 15,23 28,9.8 25.2,7 "></polygon></svg></div></div><div style="background: white; padding-right: 105px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="cd92cec5-31d6-4724-9ba7-e6bd7093c67e" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>显示结果：</span></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="d0317be4-de6e-413b-8fb9-b0737bbfa2b1" style="width: 100%; max-width: 1903px; align-self: center; margin-top: 0.5em; margin-bottom: 0.5em;"><div><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div><img src="68305c32de2afbeef9e51e2452f09e19376f9e41.png" style="display: block; object-fit: cover; border-radius: 1px; background: white; width: 100%; pointer-events: auto;"/></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="da37511b-356b-4d8c-b125-e81cccda7a81" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>我们接下来看一下代码：</span></div></div></div></div><div class="notion-selectable notion-code-block" data-block-id="b967ecb3-03b6-4993-81eb-ddbe9ea1fba4" style="width: 100%; max-width: 1711px; margin-top: 4px; margin-bottom: 4px;"><div style="display: flex;"><div style="flex-grow: 1; border-radius: 3px; text-align: left; position: relative; background: rgb(247, 246, 243); min-width: 0px; width: 100%;"><div class="line-numbers notion-code-block" style="display: flex;"><div autocapitalize="off" autocorrect="off" class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: left; font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, Courier, monospace; font-size: 85%; tab-size: 2; padding: 34px 16px 32px 32px; min-height: 1em; color: rgb(55, 53, 47); white-space: pre-wrap; word-break: break-all; min-width: 0px;'><span class="token keyword" data-token-index="0">if</span><span data-token-index="0"> __name__ </span><span class="token operator" data-token-index="0">==</span><span data-token-index="0"> </span><span class="token string" data-token-index="0">'__main__'</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">try</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># 初始化ros节点</span><span data-token-index="0">
        rospy</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">init_node</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">"face_detector"</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
        faceDetector</span><span class="token punctuation" data-token-index="0">(</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
        rospy</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">loginfo</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">"Face detector is started.."</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
        rospy</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">loginfo</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">"Please subscribe the ROS image."</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
        rospy</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">spin</span><span class="token punctuation" data-token-index="0">(</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">except</span><span data-token-index="0"> KeyboardInterrupt</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">print</span><span data-token-index="0"> </span><span class="token string" data-token-index="0">"Shutting down face detector node."</span><span data-token-index="0">
        cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">destroyAllWindows</span><span class="token punctuation" data-token-index="0">(</span><span class="token punctuation" data-token-index="0">)</span><span>
</span></div></div><div style="position: absolute; top: 3px; right: 1px; color: rgba(55, 53, 47, 0.6); display: flex; align-items: center; justify-content: flex-end; height: 25px; font-size: 11.5px; opacity: 0; transition: opacity 300ms ease-in 0s;"></div><div style="position: absolute; top: 8px; left: 8px; color: rgba(55, 53, 47, 0.6); display: flex; align-items: center; justify-content: flex-end; opacity: 0; transition: opacity 300ms ease-in 0s;"><div aria-disabled="true" class="notion-focusable" role="button" style="user-select: none; transition: background 20ms ease-in 0s; display: inline-flex; align-items: center; white-space: nowrap; height: 20px; border-radius: 3px; font-size: 12px; line-height: 1.2; padding-left: 5px; padding-right: 5px; color: rgba(55, 53, 47, 0.6); margin-right: 5px;" tabindex="-1">Python<svg class="chevronDown" style="width: 10px; height: 100%; display: block; fill: rgba(55, 53, 47, 0.3); flex-shrink: 0; backface-visibility: hidden; margin-left: 4px;" viewbox="0 0 30 30"><polygon points="15,17.4 4.8,7 2,9.8 15,23 28,9.8 25.2,7 "></polygon></svg></div></div><div style="background: white; padding-right: 105px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="704d5f2a-5175-4c87-91d0-02a54f046957" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>我们首先需要初始化ros节点，之后调用人脸检测器，然后打印出日志信息，等待回调函数等等。</span></div></div></div></div><div class="notion-selectable notion-code-block" data-block-id="6c5ef385-fd6c-4984-b3c9-16b69e14da3f" style="width: 100%; max-width: 1711px; margin-top: 4px; margin-bottom: 4px;"><div style="display: flex;"><div style="flex-grow: 1; border-radius: 3px; text-align: left; position: relative; background: rgb(247, 246, 243); min-width: 0px; width: 100%;"><div class="line-numbers notion-code-block" style="display: flex;"><div autocapitalize="off" autocorrect="off" class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: left; font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, Courier, monospace; font-size: 85%; tab-size: 2; padding: 34px 16px 32px 32px; min-height: 1em; color: rgb(55, 53, 47); white-space: pre-wrap; word-break: break-all; min-width: 0px;'><span class="token keyword" data-token-index="0">class</span><span data-token-index="0"> </span><span class="token class-name" data-token-index="0">faceDetector</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">def</span><span data-token-index="0"> </span><span class="token function" data-token-index="0">__init__</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">self</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
        rospy</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">on_shutdown</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">cleanup</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">;</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># 创建cv_bridge</span><span data-token-index="0">
        self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">bridge </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> CvBridge</span><span class="token punctuation" data-token-index="0">(</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
        self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">image_pub </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> rospy</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">Publisher</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">"cv_bridge_image"</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> Image</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> queue_size</span><span class="token operator" data-token-index="0">=</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># 获取haar特征的级联表的XML文件，文件路径在launch文件中传入</span><span data-token-index="0">
        cascade_1 </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> rospy</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">get_param</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">"~cascade_1"</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token string" data-token-index="0">""</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
        cascade_2 </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> rospy</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">get_param</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">"~cascade_2"</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token string" data-token-index="0">""</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># 使用级联表初始化haar特征检测器</span><span data-token-index="0">
        self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">cascade_1 </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">CascadeClassifier</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">cascade_1</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
        self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">cascade_2 </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">CascadeClassifier</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">cascade_2</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># 设置级联表的参数，优化人脸识别，可以在launch文件中重新配置</span><span data-token-index="0">
        self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">haar_scaleFactor  </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> rospy</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">get_param</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">"~haar_scaleFactor"</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token number" data-token-index="0">1.2</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
        self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">haar_minNeighbors </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> rospy</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">get_param</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">"~haar_minNeighbors"</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token number" data-token-index="0">2</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
        self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">haar_minSize      </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> rospy</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">get_param</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">"~haar_minSize"</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token number" data-token-index="0">40</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
        self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">haar_maxSize      </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> rospy</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">get_param</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">"~haar_maxSize"</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token number" data-token-index="0">60</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
        self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">color </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> </span><span class="token punctuation" data-token-index="0">(</span><span class="token number" data-token-index="0">50</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token number" data-token-index="0">255</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token number" data-token-index="0">50</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># 初始化订阅rgb格式图像数据的订阅者，此处图像topic的话题名可以在launch文件中重映射</span><span data-token-index="0">
        self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">image_sub </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> rospy</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">Subscriber</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">"input_rgb_image"</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> Image</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">image_callback</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> queue_size</span><span class="token operator" data-token-index="0">=</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">def</span><span data-token-index="0"> </span><span class="token function" data-token-index="0">image_callback</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">self</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> data</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># 使用cv_bridge将ROS的图像数据转换成OpenCV的图像格式</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">try</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
            cv_image </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">bridge</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">imgmsg_to_cv2</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">data</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token string" data-token-index="0">"bgr8"</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">     
            frame </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> np</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">array</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">cv_image</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> dtype</span><span class="token operator" data-token-index="0">=</span><span data-token-index="0">np</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">uint8</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">except</span><span data-token-index="0"> CvBridgeError</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> e</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">print</span><span data-token-index="0"> e
        </span><span class="token comment" data-token-index="0"># 创建灰度图像</span><span data-token-index="0">
        grey_image </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">cvtColor</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">frame</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">COLOR_BGR2GRAY</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># 创建平衡直方图，减少光线影响</span><span data-token-index="0">
        grey_image </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">equalizeHist</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">grey_image</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># 尝试检测人脸</span><span data-token-index="0">
        faces_result </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">detect_face</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">grey_image</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># 在opencv的窗口中框出所有人脸区域</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">if</span><span data-token-index="0"> </span><span class="token builtin" data-token-index="0">len</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">faces_result</span><span class="token punctuation" data-token-index="0">)</span><span class="token operator" data-token-index="0">&gt;</span><span class="token number" data-token-index="0">0</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">for</span><span data-token-index="0"> face </span><span class="token keyword" data-token-index="0">in</span><span data-token-index="0"> faces_result</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0"> 
                x</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> y</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> w</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> h </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> face
                cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">rectangle</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">cv_image</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">x</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> y</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">x</span><span class="token operator" data-token-index="0">+</span><span data-token-index="0">w</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> y</span><span class="token operator" data-token-index="0">+</span><span data-token-index="0">h</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">color</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token number" data-token-index="0">2</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># 将识别后的图像转换成ROS消息并发布</span><span data-token-index="0">
        self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">image_pub</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">publish</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">bridge</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">cv2_to_imgmsg</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">cv_image</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token string" data-token-index="0">"bgr8"</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">def</span><span data-token-index="0"> </span><span class="token function" data-token-index="0">detect_face</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">self</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> input_image</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># 首先匹配正面人脸的模型</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">if</span><span data-token-index="0"> self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">cascade_1</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
            faces </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">cascade_1</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">detectMultiScale</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">input_image</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> 
                    self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">haar_scaleFactor</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> 
                    self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">haar_minNeighbors</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> 
                    cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">CASCADE_SCALE_IMAGE</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0">
</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">haar_minSize</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">haar_maxSize</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># 如果正面人脸匹配失败，那么就尝试匹配侧面人脸的模型</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">if</span><span data-token-index="0"> </span><span class="token builtin" data-token-index="0">len</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">faces</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0"> </span><span class="token operator" data-token-index="0">==</span><span data-token-index="0"> </span><span class="token number" data-token-index="0">0</span><span data-token-index="0"> </span><span class="token keyword" data-token-index="0">and</span><span data-token-index="0"> self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">cascade_2</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
            faces </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">cascade_2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">detectMultiScale</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">input_image</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> 
                    self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">haar_scaleFactor</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> 
                    self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">haar_minNeighbors</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> 
                    cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">CASCADE_SCALE_IMAGE</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0">
</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">haar_minSize</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">haar_maxSize</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">return</span><span data-token-index="0"> faces
    </span><span class="token keyword" data-token-index="0">def</span><span data-token-index="0"> </span><span class="token function" data-token-index="0">cleanup</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">self</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">print</span><span data-token-index="0"> </span><span class="token string" data-token-index="0">"Shutting down vision node."</span><span data-token-index="0">
        cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">destroyAllWindows</span><span class="token punctuation" data-token-index="0">(</span><span class="token punctuation" data-token-index="0">)</span><span>
</span></div></div><div style="position: absolute; top: 3px; right: 1px; color: rgba(55, 53, 47, 0.6); display: flex; align-items: center; justify-content: flex-end; height: 25px; font-size: 11.5px; opacity: 0; transition: opacity 300ms ease-in 0s;"></div><div style="position: absolute; top: 8px; left: 8px; color: rgba(55, 53, 47, 0.6); display: flex; align-items: center; justify-content: flex-end; opacity: 0; transition: opacity 300ms ease-in 0s;"><div aria-disabled="true" class="notion-focusable" role="button" style="user-select: none; transition: background 20ms ease-in 0s; display: inline-flex; align-items: center; white-space: nowrap; height: 20px; border-radius: 3px; font-size: 12px; line-height: 1.2; padding-left: 5px; padding-right: 5px; color: rgba(55, 53, 47, 0.6); margin-right: 5px;" tabindex="-1">Python<svg class="chevronDown" style="width: 10px; height: 100%; display: block; fill: rgba(55, 53, 47, 0.3); flex-shrink: 0; backface-visibility: hidden; margin-left: 4px;" viewbox="0 0 30 30"><polygon points="15,17.4 4.8,7 2,9.8 15,23 28,9.8 25.2,7 "></polygon></svg></div></div><div style="background: white; padding-right: 105px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="af9d5656-c5cd-425a-8144-c52cbb3c6548" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>我们首先初始化一些参数，之后当我们接收到ros来的图像的话，我们调用回调函数，将图像转换成OpenCv的数据格式，在opencv里面创建灰度图像，创建平衡直方图，减少光线影响，之后检测人脸，这些操作都是通过调用函数来实现的，然后将人脸用一个方框框出来。</span></div></div></div></div><div class="notion-selectable notion-sub_sub_header-block" data-block-id="1fab2f83-758e-4a93-94d2-5a2f775ba23a" style="width: 100%; max-width: 1711px; margin-top: 1em; margin-bottom: 1px;"><div style='display: flex; width: 100%; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; font-weight: 600; font-size: 1.25em; line-height: 1.3; color: inherit; fill: inherit;'><div class="" contenteditable="false" data-root="true" placeholder="Heading 3" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span data-token-index="0" style="font-weight:600"><span>机器视觉-物体跟踪</span></span></div></div></div><div class="notion-selectable notion-text-block" data-block-id="d4836a69-c13c-4a8e-96d6-748d7c2975f0" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>通过第一帧与后面帧图像特征点的匹配，来实现物体跟踪，流程如下：</span></div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="e8d4e603-0b7e-46f3-8910-241f5c65f58e" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div style="margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span>1.</span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;"><span>图像输入</span></div></div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="8f238798-01c4-4eb5-b1b7-d2d510d99f7b" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div style="margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span>2.</span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;"><span>特征点采样</span></div></div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="1e8f1f3f-5166-4ab8-85b8-a09b34227510" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div style="margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span>3.</span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;"><span>两帧图像灰度值对比</span></div></div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="c9a4b6dd-adb8-4876-9ae8-dc2868299e71" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div style="margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span>4.</span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;"><span>特征点估计</span></div></div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="7f6f8669-80f1-4862-8a6b-c8748f1f03ff" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div style="margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span>5.</span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;"><span>特征点过滤</span></div></div></div></div></div><div class="notion-selectable notion-numbered_list-block" data-block-id="8c7de579-a6bd-4f30-a03a-cef118c3369e" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div style="margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><span>6.</span></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;"><span>结果输出</span></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="131fbea3-b57c-4446-8e1e-8b1df8baa5de" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>代码文件以及视频解释等相关文件在我github里面都可以去找到，这里不方便贴出来。分别在三个终端运行以下命令:</span></div></div></div></div><div class="notion-selectable notion-code-block" data-block-id="e191fb39-3190-470f-8242-fd9e151a0dab" style="width: 100%; max-width: 1711px; margin-top: 4px; margin-bottom: 4px;"><div style="display: flex;"><div style="flex-grow: 1; border-radius: 3px; text-align: left; position: relative; background: rgb(247, 246, 243); min-width: 0px; width: 100%;"><div class="line-numbers notion-code-block" style="display: flex;"><div autocapitalize="off" autocorrect="off" class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: left; font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, Courier, monospace; font-size: 85%; tab-size: 2; padding: 34px 16px 32px 32px; min-height: 1em; color: rgb(55, 53, 47); white-space: pre-wrap; word-break: break-all; min-width: 0px;'><span>roslaunch robot_vision usb_cam.launch
roslaunch robot_vision motion_detector.launch
rqt_image_view</span></div></div><div style="position: absolute; top: 3px; right: 1px; color: rgba(55, 53, 47, 0.6); display: flex; align-items: center; justify-content: flex-end; height: 25px; font-size: 11.5px; opacity: 0; transition: opacity 300ms ease-in 0s;"></div><div style="position: absolute; top: 8px; left: 8px; color: rgba(55, 53, 47, 0.6); display: flex; align-items: center; justify-content: flex-end; opacity: 0; transition: opacity 300ms ease-in 0s;"><div aria-disabled="true" class="notion-focusable" role="button" style="user-select: none; transition: background 20ms ease-in 0s; display: inline-flex; align-items: center; white-space: nowrap; height: 20px; border-radius: 3px; font-size: 12px; line-height: 1.2; padding-left: 5px; padding-right: 5px; color: rgba(55, 53, 47, 0.6); margin-right: 5px;" tabindex="-1">Plain Text<svg class="chevronDown" style="width: 10px; height: 100%; display: block; fill: rgba(55, 53, 47, 0.3); flex-shrink: 0; backface-visibility: hidden; margin-left: 4px;" viewbox="0 0 30 30"><polygon points="15,17.4 4.8,7 2,9.8 15,23 28,9.8 25.2,7 "></polygon></svg></div></div><div style="background: white; padding-right: 105px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="99765b55-c07d-4e40-8a71-ad04d4c1fa9a" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>这里效果太差，就不给予演示了。函数如下：</span></div></div></div></div><div class="notion-selectable notion-code-block" data-block-id="6cb79876-04c1-46fb-8c9f-4cfdf1004757" style="width: 100%; max-width: 1711px; margin-top: 4px; margin-bottom: 4px;"><div style="display: flex;"><div style="flex-grow: 1; border-radius: 3px; text-align: left; position: relative; background: rgb(247, 246, 243); min-width: 0px; width: 100%;"><div class="line-numbers notion-code-block" style="display: flex;"><div autocapitalize="off" autocorrect="off" class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="false" style='flex-grow: 1; flex-shrink: 1; text-align: left; font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, Courier, monospace; font-size: 85%; tab-size: 2; padding: 34px 16px 32px 32px; min-height: 1em; color: rgb(55, 53, 47); white-space: pre-wrap; word-break: break-all; min-width: 0px;'><span class="token comment" data-token-index="0">#!/usr/bin/env python</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># -*- coding: utf-8 -*-</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">import</span><span data-token-index="0"> rospy
</span><span class="token keyword" data-token-index="0">import</span><span data-token-index="0"> cv2
</span><span class="token keyword" data-token-index="0">import</span><span data-token-index="0"> numpy </span><span class="token keyword" data-token-index="0">as</span><span data-token-index="0"> np
</span><span class="token keyword" data-token-index="0">from</span><span data-token-index="0"> sensor_msgs</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">msg </span><span class="token keyword" data-token-index="0">import</span><span data-token-index="0"> Image</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> RegionOfInterest
</span><span class="token keyword" data-token-index="0">from</span><span data-token-index="0"> cv_bridge </span><span class="token keyword" data-token-index="0">import</span><span data-token-index="0"> CvBridge</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> CvBridgeError
 
</span><span class="token keyword" data-token-index="0">class</span><span data-token-index="0"> </span><span class="token class-name" data-token-index="0">motionDetector</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">def</span><span data-token-index="0"> </span><span class="token function" data-token-index="0">__init__</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">self</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
        rospy</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">on_shutdown</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">cleanup</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">;</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># 创建cv_bridge</span><span data-token-index="0">
        self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">bridge </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> CvBridge</span><span class="token punctuation" data-token-index="0">(</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
        self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">image_pub </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> rospy</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">Publisher</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">"cv_bridge_image"</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> Image</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> queue_size</span><span class="token operator" data-token-index="0">=</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># 设置参数：最小区域、阈值</span><span data-token-index="0">
        self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">minArea   </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> rospy</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">get_param</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">"~minArea"</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token number" data-token-index="0">500</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
        self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">threshold </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> rospy</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">get_param</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">"~threshold"</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token number" data-token-index="0">25</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
 
        self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">firstFrame </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> </span><span class="token boolean" data-token-index="0">None</span><span data-token-index="0">
        self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">text </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> </span><span class="token string" data-token-index="0">"Unoccupied"</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># 初始化订阅rgb格式图像数据的订阅者，此处图像topic的话题名可以在launch文件中重映射</span><span data-token-index="0">
        self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">image_sub </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> rospy</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">Subscriber</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">"input_rgb_image"</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> Image</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">image_callback</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> queue_size</span><span class="token operator" data-token-index="0">=</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">def</span><span data-token-index="0"> </span><span class="token function" data-token-index="0">image_callback</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">self</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> data</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># 使用cv_bridge将ROS的图像数据转换成OpenCV的图像格式</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">try</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
            cv_image </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">bridge</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">imgmsg_to_cv2</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">data</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token string" data-token-index="0">"bgr8"</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">     
            frame </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> np</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">array</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">cv_image</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> dtype</span><span class="token operator" data-token-index="0">=</span><span data-token-index="0">np</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">uint8</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">except</span><span data-token-index="0"> CvBridgeError</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> e</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">print</span><span data-token-index="0"> e
 
        </span><span class="token comment" data-token-index="0"># 创建灰度图像</span><span data-token-index="0">
        gray </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">cvtColor</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">frame</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">COLOR_BGR2GRAY</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
        gray </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">GaussianBlur</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">gray</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token punctuation" data-token-index="0">(</span><span class="token number" data-token-index="0">21</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token number" data-token-index="0">21</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token number" data-token-index="0">0</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># 使用两帧图像做比较，检测移动物体的区域</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">if</span><span data-token-index="0"> self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">firstFrame </span><span class="token keyword" data-token-index="0">is</span><span data-token-index="0"> </span><span class="token boolean" data-token-index="0">None</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
            self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">firstFrame </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> gray
            </span><span class="token keyword" data-token-index="0">return</span><span data-token-index="0">  
        frameDelta </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">absdiff</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">firstFrame</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> gray</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
        thresh </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">threshold</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">frameDelta</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">threshold</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token number" data-token-index="0">255</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">THRESH_BINARY</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">[</span><span class="token number" data-token-index="0">1</span><span class="token punctuation" data-token-index="0">]</span><span data-token-index="0">
 
        thresh </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">dilate</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">thresh</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token boolean" data-token-index="0">None</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> iterations</span><span class="token operator" data-token-index="0">=</span><span class="token number" data-token-index="0">2</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
        binary</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> cnts</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> hierarchy</span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">findContours</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">thresh</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">copy</span><span class="token punctuation" data-token-index="0">(</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">RETR_EXTERNAL</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">CHAIN_APPROX_SIMPLE</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">for</span><span data-token-index="0"> c </span><span class="token keyword" data-token-index="0">in</span><span data-token-index="0"> cnts</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># 如果检测到的区域小于设置值，则忽略</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">if</span><span data-token-index="0"> cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">contourArea</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">c</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0"> </span><span class="token operator" data-token-index="0">&lt;</span><span data-token-index="0"> self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">minArea</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">continue</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># 在输出画面上框出识别到的物体</span><span data-token-index="0">
</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">x</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> y</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> w</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> h</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0"> </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">boundingRect</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">c</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
            cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">rectangle</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">frame</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">x</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> y</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">x </span><span class="token operator" data-token-index="0">+</span><span data-token-index="0"> w</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> y </span><span class="token operator" data-token-index="0">+</span><span data-token-index="0"> h</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token punctuation" data-token-index="0">(</span><span class="token number" data-token-index="0">50</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token number" data-token-index="0">255</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token number" data-token-index="0">50</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token number" data-token-index="0">2</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
            self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">text </span><span class="token operator" data-token-index="0">=</span><span data-token-index="0"> </span><span class="token string" data-token-index="0">"Occupied"</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># 在输出画面上打当前状态和时间戳信息</span><span data-token-index="0">
        cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">putText</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">frame</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token string" data-token-index="0">"Status: {}"</span><span class="token punctuation" data-token-index="0">.</span><span class="token builtin" data-token-index="0">format</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">text</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token punctuation" data-token-index="0">(</span><span class="token number" data-token-index="0">10</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token number" data-token-index="0">20</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0">
            cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">FONT_HERSHEY_SIMPLEX</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token number" data-token-index="0">0.5</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token punctuation" data-token-index="0">(</span><span class="token number" data-token-index="0">0</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token number" data-token-index="0">0</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token number" data-token-index="0">255</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token number" data-token-index="0">2</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># 将识别后的图像转换成ROS消息并发布</span><span data-token-index="0">
        self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">image_pub</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">publish</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">self</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">bridge</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">cv2_to_imgmsg</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">frame</span><span class="token punctuation" data-token-index="0">,</span><span data-token-index="0"> </span><span class="token string" data-token-index="0">"bgr8"</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">def</span><span data-token-index="0"> </span><span class="token function" data-token-index="0">cleanup</span><span class="token punctuation" data-token-index="0">(</span><span data-token-index="0">self</span><span class="token punctuation" data-token-index="0">)</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">print</span><span data-token-index="0"> </span><span class="token string" data-token-index="0">"Shutting down vision node."</span><span data-token-index="0">
        cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">destroyAllWindows</span><span class="token punctuation" data-token-index="0">(</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">if</span><span data-token-index="0"> __name__ </span><span class="token operator" data-token-index="0">==</span><span data-token-index="0"> </span><span class="token string" data-token-index="0">'__main__'</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">try</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
</span><span class="token comment" data-token-index="0"># 初始化ros节点</span><span data-token-index="0">
        rospy</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">init_node</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">"motion_detector"</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
        rospy</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">loginfo</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">"motion_detector node is started..."</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
        rospy</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">loginfo</span><span class="token punctuation" data-token-index="0">(</span><span class="token string" data-token-index="0">"Please subscribe the ROS image."</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
        motionDetector</span><span class="token punctuation" data-token-index="0">(</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
        rospy</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">spin</span><span class="token punctuation" data-token-index="0">(</span><span class="token punctuation" data-token-index="0">)</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">except</span><span data-token-index="0"> KeyboardInterrupt</span><span class="token punctuation" data-token-index="0">:</span><span data-token-index="0">
</span><span class="token keyword" data-token-index="0">print</span><span data-token-index="0"> </span><span class="token string" data-token-index="0">"Shutting down motion detector node."</span><span data-token-index="0">
        cv2</span><span class="token punctuation" data-token-index="0">.</span><span data-token-index="0">destroyAllWindows</span><span class="token punctuation" data-token-index="0">(</span><span class="token punctuation" data-token-index="0">)</span><span>
</span></div></div><div style="position: absolute; top: 3px; right: 1px; color: rgba(55, 53, 47, 0.6); display: flex; align-items: center; justify-content: flex-end; height: 25px; font-size: 11.5px; opacity: 0; transition: opacity 300ms ease-in 0s;"></div><div style="position: absolute; top: 8px; left: 8px; color: rgba(55, 53, 47, 0.6); display: flex; align-items: center; justify-content: flex-end; opacity: 0; transition: opacity 300ms ease-in 0s;"><div aria-disabled="true" class="notion-focusable" role="button" style="user-select: none; transition: background 20ms ease-in 0s; display: inline-flex; align-items: center; white-space: nowrap; height: 20px; border-radius: 3px; font-size: 12px; line-height: 1.2; padding-left: 5px; padding-right: 5px; color: rgba(55, 53, 47, 0.6); margin-right: 5px;" tabindex="-1">Python<svg class="chevronDown" style="width: 10px; height: 100%; display: block; fill: rgba(55, 53, 47, 0.3); flex-shrink: 0; backface-visibility: hidden; margin-left: 4px;" viewbox="0 0 30 30"><polygon points="15,17.4 4.8,7 2,9.8 15,23 28,9.8 25.2,7 "></polygon></svg></div></div><div style="background: white; padding-right: 105px;"></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="f9727dfb-01cb-4f70-bae5-ba7ab20f91e9" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>里面代码的意思跟之前的也都差不多。不同点在，这里主要是基于图像差异识别到运动的物体，最后标识，识别并结果发布。</span></div></div></div></div><div class="notion-selectable notion-sub_sub_header-block" data-block-id="e3d822bd-8e1f-43e7-aa5f-548d28e8b079" style="width: 100%; max-width: 1711px; margin-top: 1em; margin-bottom: 1px;"><div style='display: flex; width: 100%; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; font-weight: 600; font-size: 1.25em; line-height: 1.3; color: inherit; fill: inherit;'><div class="" contenteditable="false" data-root="true" placeholder="Heading 3" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span data-token-index="0" style="font-weight:600"><span>二维码识别</span></span></div></div></div><div class="notion-selectable notion-text-block" data-block-id="016f19fb-c5a7-4ead-be64-45b65da6fd31" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>安装以下功能包：</span></div></div></div></div><div class="notion-selectable notion-quote-block" data-block-id="8ac43082-0fd9-4585-b8db-48aadb1062e1" style="width: 100%; max-width: 1711px; margin-top: 4px; margin-bottom: 4px;"><div style="font-size: 1.2em; padding: 3px 2px; color: inherit; fill: inherit; display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="Empty quote" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); border-left: 3px solid currentcolor; padding-left: 0.9em; padding-right: 0.9em;"><span>sudo apt-get install ros-kinetic-ar-track-alvar</span></div></div></div><div class="notion-selectable notion-image-block" data-block-id="97a4605e-5f76-4df6-9e0f-4f34af882904" style="width: 100%; max-width: 1903px; align-self: center; margin-top: 0.5em; margin-bottom: 0.5em;"><div><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div><img src="5ea450eefc2abc17209e1e224e8cae7ebf0cb329.png" style="display: block; object-fit: cover; border-radius: 1px; background: white; width: 100%; pointer-events: auto;"/></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="96fdd0b8-ccb6-488a-855f-3708d3f685e0" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>我们可以在以下目录中找到相应的安装的文件。这个功能包也有很多工具能够帮助我们去创建二维码。</span></div></div></div></div><div class="notion-selectable notion-quote-block" data-block-id="e4db6cfe-3442-45d1-bb19-2ac930f7a9e6" style="width: 100%; max-width: 1711px; margin-top: 4px; margin-bottom: 4px;"><div style="font-size: 1.2em; padding: 3px 2px; color: inherit; fill: inherit; display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="Empty quote" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); border-left: 3px solid currentcolor; padding-left: 0.9em; padding-right: 0.9em;"><span>roscore rosrun ar_track_alvar createMarker</span></div></div></div><div class="notion-selectable notion-image-block" data-block-id="a22571b5-da8f-4030-9f55-73eb34a7e147" style="width: 100%; max-width: 1903px; align-self: center; margin-top: 0.5em; margin-bottom: 0.5em;"><div><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div style="width: 100%; height: 100%;"><img src="2968b18ad080043af51be42f8e05bcd1c5b8f271.png" style="display: block; object-fit: cover; border-radius: 1px; width: 100%; pointer-events: auto;"/></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="94fd6cff-fbd7-49f4-bc92-bc3d6e0f5c6e" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>我们可以通过多种方式，像数字、文件、网址等等来创建二维码，还可以去定义我们二维码的大小什么的。接下来我们实现对它的识别：</span></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="ddfca617-0a7a-41c2-8ce1-8bdc094893b5" style="width: 100%; max-width: 1903px; align-self: center; margin-top: 0.5em; margin-bottom: 0.5em;"><div><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div style="width: 100%; height: 100%;"><img src="526ad4d1932e46199601a8e8f5630510249204a1.png" style="display: block; object-fit: cover; border-radius: 1px; width: 100%; pointer-events: auto;"/></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="6f8d6a09-66bd-4762-8d5d-b200db29d6c4" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>上述命令分别是创建一个大小为5的数字0，大小为5的数字1，大小为5的数字2。   接下来我们去工作空间下看一下launch文件：</span></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="b7def3b9-6aa6-4526-8069-66eefd8c22c2" style="width: 100%; max-width: 1903px; align-self: center; margin-top: 0.5em; margin-bottom: 0.5em;"><div><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div style="width: 100%; height: 100%;"><img src="bc28a3c14d5c0b3c3bdb9d175f2a55fa5fa6340b.png" style="display: block; object-fit: cover; border-radius: 1px; width: 100%; pointer-events: auto;"/></div></div></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="c25e9aa2-9df7-4271-a482-78a47a057228" style="width: 100%; max-width: 1903px; align-self: center; margin-top: 0.5em; margin-bottom: 0.5em;"><div><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div style="width: 100%; height: 100%;"><img src="c7d35ac4166362812838933dcc51f3be8222b24a.png" style="display: block; object-fit: cover; border-radius: 1px; width: 100%; pointer-events: auto;"/></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="e75291be-471b-41f1-9a92-5dd9d8e5fbf5" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>核心部分是node节点，通过启动individualMarkersNoKinect节点去识别二维码。里面加一些参数，像什么二维码的尺寸等。</span></div></div></div></div><div class="notion-selectable notion-quote-block" data-block-id="887b397b-a5e1-4f7b-b0b3-8b77ecea14cb" style="width: 100%; max-width: 1711px; margin-top: 4px; margin-bottom: 4px;"><div style="font-size: 1.2em; padding: 3px 2px; color: inherit; fill: inherit; display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="Empty quote" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); border-left: 3px solid currentcolor; padding-left: 0.9em; padding-right: 0.9em;"><span>roslaunch robot_vision usb_cam_with_calibration.launch roslaunch robot_vision ar_track_camera.launch</span></div></div></div><div class="notion-selectable notion-text-block" data-block-id="1e6db56c-29c3-4dc4-9cb7-f0a28e2dc756" style="width: 100%; max-width: 1711px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div class="" contenteditable="false" data-root="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span>rostopic echo /ar_pose_marker查看二维码姿态</span></div></div></div></div><div class="notion-selectable notion-quote-block" data-block-id="f8c8c7ff-3f13-469d-a16f-5e1e371d1651" style="width: 100%; max-width: 1711px; margin-top: 4px; margin-bottom: 0px;"><div style="font-size: 1.2em; padding: 3px 2px; color: inherit; fill: inherit; display: flex;"><div class="" contenteditable="false" data-root="true" placeholder="Empty quote" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); border-left: 3px solid currentcolor; padding-left: 0.9em; padding-right: 0.9em;"><span>我的微信公众号名称：深度学习与先进智能决策 微信公众号ID：MultiAgenxt1024 公众号介绍：主要研究强化学习、计算机视觉、深度学习、机器学习等相关内容，分享学习过程中的学习笔记和心得！期待您的关注，欢迎一起学习交流进步！</span></div></div></div></div><div class="notion-presence-container" style="position: absolute; top: 0px; left: 0px; pointer-events: none; z-index: 1;"><div></div></div></div><div style="position: absolute; top: 0px; left: 0px;"><div></div></div></div></div></div></div><textarea style="opacity: 0; pointer-events: none; position: fixed; left: 0px; top: 0px;"></textarea><textarea style="opacity: 0; pointer-events: none; position: fixed; left: 0px; top: 0px;"></textarea><div style="width: env(safe-area-inset-bottom);"></div><script src="4f81ce7dd4fdfb05ecea2042ffef36115ac55ccf.js" type="text/javascript"></script><iframe aria-hidden="true" id="intercom-frame" style="position: absolute !important; opacity: 0 !important; width: 1px !important; height: 1px !important; top: 0 !important; left: 0 !important; border: none !important; display: block !important; z-index: -1 !important; pointer-events: none;" tabindex="-1" title="Intercom"></iframe></body></html>